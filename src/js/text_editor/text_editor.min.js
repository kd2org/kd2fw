window.textEditor=function(t){if(!document.getElementById(t))throw new Error("Invalid ID parameter: "+t);return this.id=t,this.textarea=document.getElementById(t),this.shortcuts=[],"selectionStart"in this.textarea&&(this.textarea.addEventListener("keydown",this.keyEvent.bind(this),!0),this.textarea.addEventListener("keypress",this.keyEvent.bind(this),!0),!0)},textEditor.prototype.keyEvent=function(t){var e,t=t||window.event;for(e in this.shortcuts){var r=this.shortcuts[e];if(!t.metaKey&&(!(t.ctrlKey&&!r.ctrl||r.ctrl&&!t.ctrlKey)&&!(t.shiftKey&&!r.shift||r.shift&&!t.shiftKey)&&!(t.altKey&&!r.alt||r.alt&&!t.altKey)&&(e=this.matchKeyPress(r.key,t)))){if("function"==typeof r.callback)return!r.callback.call(this,t,e)||this.preventDefault(t);var o=(r.ctrl?"Ctrl-":"")+(r.alt?"Alt-":"");throw o+=(r.shift?"Shift-":"")+r,new Error("Invalid callback type for shortcut "+o)}}return!0},textEditor.prototype.matchKeyPress=function(t,e){return!(e.defaultPrevented||!e.key)&&(t=t.toLowerCase(),e.key.toLowerCase()==t&&t)},textEditor.prototype.preventDefault=function(t){return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.returnValue=!1,!(t.cancelBubble=!0)},textEditor.prototype.getSelection=function(){var t=this.textarea,e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}},textEditor.prototype.replaceSelection=function(t,e){var r=t.start,o=r+e.length;return this.textarea.focus(),this.setSelection(r,t.end),document.execCommand("insertText",!1,e),this.setSelection(r,o),{start:r,end:o,length:e.length,text:e}},textEditor.prototype.insertAtPosition=function(t,e,r){t+=e.length;return this.textarea.focus(),document.execCommand("insertText",!1,e),r=r||t,this.setSelection(r,r)},textEditor.prototype.setSelection=function(t,e){var r=this.textarea;return r.focus(),r.selectionStart=t,r.selectionEnd=e,this.getSelection()},textEditor.prototype.scrollToSelection=function(t){var e=this.textarea,r=e.value.substr(t.end);e.value=e.value.substr(0,t.end),e.scrollTop=1e5;var o=e.scrollTop;e.value+=r,e.scrollTop=o,this.setSelection(t.start,t.end)},textEditor.prototype.wrapSelection=function(t,e,r){var o=this.textarea,n=o.scrollTop,i=t.text,t=this.replaceSelection(t,e+i+r);return""==i&&(t=this.setSelection(t.start+e.length,t.start+e.length)),o.scrollTop=n,t};